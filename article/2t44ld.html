<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@latest/myjs/loadscripts.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@latest/myjs/jump-1.4.js"></script>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@latest/img/favicon.ico" />
    <link rel="icon" href="/img/favicon.ico" type="image/ico"/>
    <link rel="stylesheet" href="/mycss/style.css">

    <script src="/resources/resources.js"></script>
    <script src="/myjs/scriptlist.js"></script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg">🚀</button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <div id="homepage-center">
            <div id="slogan">
                <i id="wolf-logo" style="font-style: normal;" class="mr-4">🌑</i><span id="slogan-text"></span>
            </div>
            <div id="homepage-btn">
                <div id="showmore"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; About Me & This Blog</div>
                <div id="showhacknical"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Github Analysis</div>
                <div id="toarticles"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Tech Articles</div>
            </div>
        </div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistics</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Online:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Chars:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Categories:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tags:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Last update:</td>
                    <td style="text-align:left" id="stat_last_update"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search with keywords (algolia)">
            <div id="searchprocessbar">
                <div id="spb-out" class="spb-outter-animate"></div>
                <div id="spb-in" class="spb-inner-animate"></div>
            </div>
            <div class="input-group-append">
                <button id="cleanbut" class="btn btn-light" type="button" title="clear search">cls</button>
                <button id="categories" class="btn btn-light" type="button">cates</button>
                <button id="tags" class="btn btn-light" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn btn-light" type="button" title="search">sch</button>
            </div>
        </div>
        <div id="searchrscount" class="unselectable"></div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container markdown-toc"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        
          <h3 id="e25a21eb">Introduction</h3><p>在排序算法中有堆排序，而要理解好堆排序，首先我们得先理解好堆的概念，一般在数据结构上，我们把优先队列的数据结构称为堆，那什么是有限队列呢？它能应用在哪些场景呢？这些是本篇要介绍的重点</p>

          <h3 id="d4c2b117">Priority Queue</h3><p>定义：</p>
<blockquote>
<p>优先队列至少要实现以下个操作：insert（插入）；deleteMin（删除最小元素），要找出、删除并返回队列中最小的元素</p>
<p>插入等于是入队，删除等于是出队：</p>
<pre><code class="language-graph">      删除最小元素         ┏------------------┓      插入元素
&lt;-------------------------|     优先队列      |&lt;--------------------
                          ┗------------------┛</code></pre>
</blockquote>

          <h3 id="258a4df4">Binary Heap</h3><p>最常见的堆实现就是二叉堆，和二叉查找树一样，二叉堆也有两个性质：结构性、堆序性</p>
<ul>
<li><strong>结构性：</strong>堆在逻辑上可以看作的一个完全二叉树，而且因为完全二叉树的规律性，我们可以使用数组来存放堆元素，其中：<ol>
<li>对于数组上任意<code>i</code>位置，其左儿子的位置在<code>2i</code>上，右儿子在<code>2i + 1</code>上，其父亲在<code>└i / 2┘</code>位置；</li>
<li>最大堆的大小需要提前决定一个合适的值，尽量减少数组扩容；</li>
</ol>
</li>
<li><strong>堆序性：</strong>堆中任意根节点应该<strong>小于等于</strong>它的后裔；</li>
</ul>
<pre><code class="language-graph">            13                   13
          /    \               /    \
        14     15             6     16
        / \                  / \
       19 27                19  27
           堆                    非堆       </code></pre>

          <h4 id="f119e8a9">Insert</h4><p>为了将一个元素X插入到堆中，我们在堆的下一个可用位置（堆的尾部）创建一个“空穴”，以保证该堆还是一个完全树</p>
<p>如果X可以放在空穴中而不破坏堆序性（如果此时X的值大于等于空穴的父节点的值），那么X就放在这个位置；否则，我们将该空穴的父节点放到空穴，然后父节点的原来的位置充当心的空穴；以此直到X能够放进空穴为止；</p>
<pre><code class="language-graph">比如插入5
        13                   13                 ▢                 5
      /    \               /    \             /    \            /    \
    21     16     →       ▢     16     →    13     16     →   13     16
    / \                  / \                / \               / \
   24  ▢                19 21             19  21            19  21  </code></pre>
<p>这个过程叫上滤（percolate up），相关的伪码：</p>
<pre><code class="language-pseudocode">// arr[]
insert(x):
    hole = ++currentSize;
    while x &lt; arr[hole / 2]:
        arr[hole] = arr[hole/2];
        hole /= 2;
    arr[hole] = x;</code></pre>
<p>根据<em>《数据结构与算法分析——Mark Allen Weiss》</em>的结论，<strong>插入/上滤算法的平均效率为<em>O(1)<em>，最坏为</em>O(logN)</em></strong></p>

          <h4 id="936a8c8">DeleteMin</h4><p>要删除最小元素，首先把堆顶元素挖空（数组第一个元素），然后再调整堆序性，由于这时候少了一个元素，所以要重新调整堆，我们把堆中最后一个元素当成对比元素，如果对比元素可以放在该空穴，那么就放置，否则将该空穴位置上较小的子元素放置到空穴处，原较小元素的位置称为新的空穴，再和对比元素进行比较；</p>
<pre><code class="language-graph">        ▢                    13                 13               13
      /    \               /    \             /    \            /    \
     13    16     →       ▢     16     →    19     16     →   19    16
    / \                  / \                / \               /
   24  21               19  21             ▢  21            21</code></pre>
<p>但是当堆中有偶数个元素的时候，再使用这种算法会出现问题：</p>
<pre><code class="language-graph">        ▢                    13                 13               13
      /    \               /    \             /    \            /    \
     13    16     →      ▢      16     →    21     16     →   21    16
    / \    /            /  \    /           / \    /         /  \  
  24  21 19            24  21 19           24  ▢ 19        24   19?</code></pre>
<p>所以我们需要巧妙地将每个根节点都视为都有2个子节点，实现的伪码：</p>
<pre><code class="language-pseudocode">// arr[]，且元素从下标1开始存放，保证当下标i为1的时候，其两倍是有效的下标2
deleteMin():
    min = findMin();
    arr[1] = arr[currentSize--];
    percolateDown(1);
    return min;

percolateDown(hole):
    tmp = arr[hole];
    while hole * 2 &lt;= currentSize:
        child = hole * 2;
        if child != currentSize and arr[child + 1] &lt; arr[child]:
            child++;
        if arr[child] &lt; tmp:
            arr[hole] = arr[child];
        else:
            break;
        hole = child;
    arr[hole] = tmp;</code></pre>
<pre><code class="language-graph">若原来15有左子节点19，则这时候堆顶为19，且将它挖空，tmp为19
        ▢                    13                 13 
      /    \               /    \             /    \ 
     13    16     →      ▢      16     →    19     16 
    / \                 /  \    /           / \   
  24  21               24  21 19           24  21 </code></pre>
<p>如上图，执行情况：</p>
<ol>
<li>当<code>hole = 1</code>时，这时候child为2，于是会对比13和16的值，发现13小于16，所以child还是2，然后<code>tmp = 19</code>大于<code>arr[child] = 13</code>，于是13填到空穴处，13原来的位置称为新的空穴；</li>
<li>当<code>hole = 2</code>，这时候child为4，于是会对比24和21的值，发现24大于21，所以child加一，然后<code>tmp = 19</code>小于<code>arr[child] = 21</code>，于是break；</li>
<li>最后退出了循环，直接<code>arr[hole] = tmp;</code></li>
</ol>
<p>根据<em>《数据结构与算法分析——Mark Allen Weiss》</em>的结论，<strong>删除最小点/下滤算法的平均效率为<em>O(logN)</em></strong></p>

          <h4 id="f0c3d1d1">BuildHeap</h4><p>二叉堆的还有一个重要的操作就是构建堆，有两种思路，一是对每个新增节点都进行插入操作，<strong>平均效率为<em>O(N)</em></strong>;</p>
<p>还有就是直接对原数组从中间节点（最后一个父节点）开始忘数组前面一一进行下滤，而这个的平均效率也被证明<strong>为<em>O(N)</em></strong>；</p>
<pre><code class="language-pseudocode">buildHeap():
    for i = currentSize / 2 -&gt; 1:
        percolateDown(i);</code></pre>

          <h3 id="2db4bd39">Application For BinaryHeap</h3><ol>
<li>寻找序列中第k小的数：以线性效率建堆之后，调用<code>deleteMin()</code>k - 1次，此时堆顶就是第k小的数，因此平均效率为<strong><em>O(N + klogN)</em></strong>；</li>
<li>寻找序列中前k小的数：调用<code>deleteMin()</code>k 次，此时堆顶就是第k小的数；</li>
<li>“寻找序列中前90%大的数”，变治为“寻找序列中前10%小的数”；</li>
</ol>

          <h3 id="3096ad65">Heap Sort</h3><p>我们观察一下二叉堆的应用，如果说，应用1的k等于N的话，那么我们等于将序列从小到大输出了出来，效率为<strong><em>O(NlogN)</em></strong>再加上<strong><em>O(N)</em></strong>的空间，那么我们能不能够优化一下呢？</p>
<p>我们在建堆的时候申请了N的空间，每次删除最小元素之后，虽然物理空间数组长度还是N，但是我们的关心的堆范围已经，假如说我们每次删除最小元素之后，把最小元素放在删除之前堆的大小的尾部，那么等所有删除最小元素操作完之后，我们就得到了一个逆序的数组，我们把实现这种功能的方法叫做小顶堆排序</p>
<p>于是我们发现：小顶堆能在<strong><em>O(NlogN)</em></strong>时间常量空间内把乱序数组整理称逆序数组！</p>
<p>我们再反过来想，如果要对数组进行排序，是不是可以构建<strong>大顶堆</strong>然后以相同的思路<strong>删除最大元素</strong>呢？</p>
<p>按照书上的思路，实现起来就是：</p>
<pre><code class="language-java">public static void heapSort(int[] arr) {
    for (int i = arr.length / 2 - 1; i &gt;= 0; i--)
        percDown(arr, i, arr.length);

    for (int i = arr.length - 1; i &gt; 0; i--) {
        swap(arr, 0, i);
        percDown(arr, 0, i);
    }
}

public static void percDown(int[] arr, int hole, int nowSize) {
    int child;
    int tmp = arr[hole];
    for (; hole * 2 + 1 &lt; nowSize; hole = child) {
        child = hole * 2 + 1;
        if (child != nowSize - 1 &amp;&amp; arr[child] &lt; arr[child + 1]) {
            child++;
        }
        if (tmp &lt; arr[child]) {
            arr[hole] = arr[child];
        } else break;
    }
    arr[hole] = tmp;
}</code></pre>
<p>还有一种实现方式，但是这个效率稍差，参考<a href="https://www.geeksforgeeks.org/heap-sort/">GeeksforGeeks</a></p>
<pre><code class="language-java">public void sort(int arr[]) 
{ 
    // Build heap
    for (int i = arr.length / 2 - 1; i &gt;= 0; i--) 
        heapify(arr, arr.length, i); 

    for (int i= arr.length - 1; i &gt; 0; i--) { 
        int temp = arr[0]; 
        arr[0] = arr[i]; 
        arr[i] = temp; 
        heapify(arr, i, 0); 
    } 
} 

// To heapify a subtree rooted with node i which is 
// an index in arr[]. n is size of heap 
void heapify(int arr[], int currentSize, int holeIndex) { 
    int largestIndex = holeIndex; // Initialize largest as root 
    int leftIndex = 2 * holeIndex + 1;
    int rightIndex = 2 * holeIndex + 2;

    // If left child is larger than root 
    if (leftIndex &lt; currentSize &amp;&amp; arr[leftIndex] &gt; arr[largestIndex]) 
        largestIndex = leftIndex; 

    // If right child is larger than largest so far 
    if (rightIndex &lt; currentSize &amp;&amp; arr[rightIndex] &gt; arr[largestIndex]) 
        largestIndex = rightIndex; 

    // If largest is not root 
    if (largestIndex != holeIndex) { 
        int swap = arr[holeIndex]; 
        arr[holeIndex] = arr[largestIndex]; 
        arr[largestIndex] = swap; 
        // Recursively heapify the affected sub-tree 
        heapify(arr, currentSize, largestIndex); 
    } 
} </code></pre>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

</body>

</html>